{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport gql from 'graphql-tag';\nimport { CURRENT_USER_QUERY } from './User';\nconst REMOVE_FROM_CART_MUTATION = gql`\n  mutation removeFromCart($id: ID!) {\n    removeFromCart(id: $id) {\n      id\n    }\n  }\n`;\nconst BigButton = styled.button.withConfig({\n  displayName: \"RemoveFromCart__BigButton\",\n  componentId: \"sc-1fmc10-0\"\n})([\"font-size:3rem;background:none;border:0;&:hover{color:\", \";cursor:pointer;}\"], props => props.theme.red);\n\nclass RemoveFromCart extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"update\", (cache, payload) => {\n      console.log('Running remove from cart update fn'); // 1. first read the cache\n\n      const data = cache.readQuery({\n        query: CURRENT_USER_QUERY\n      });\n      console.log(data); // 2. remove that item from the cart\n\n      const cartItemId = payload.data.removeFromCart.id;\n      data.me.cart = data.me.cart.filter(cartItem => cartItem.id !== cartItemId); // 3. write it back to the cache\n\n      cache.writeQuery({\n        query: CURRENT_USER_QUERY,\n        data\n      });\n    });\n  }\n\n  render() {\n    return __jsx(Mutation, {\n      mutation: REMOVE_FROM_CART_MUTATION,\n      variables: {\n        id: this.props.id\n      },\n      update: this.update,\n      optimisticResponse: {\n        __typename: 'Mutation',\n        removeFromCart: {\n          __typename: 'CartItem',\n          id: this.props.id\n        }\n      }\n    }, (removeFromCart, {\n      loading,\n      error\n    }) => __jsx(BigButton, {\n      disabled: loading,\n      onClick: () => {\n        removeFromCart().catch(err => alert(err.message));\n      },\n      title: \"Delete Item\"\n    }, \"\\xD7\"));\n  }\n\n}\n\nexport default RemoveFromCart;","map":null,"metadata":{},"sourceType":"module"}